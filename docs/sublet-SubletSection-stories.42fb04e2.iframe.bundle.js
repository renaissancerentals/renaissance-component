"use strict";(self.webpackChunk_renaissancerentals_renaissance_component=self.webpackChunk_renaissancerentals_renaissance_component||[]).push([[4840],{"./src/sublet/SubletSection.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>SubletSection_stories});var react=__webpack_require__("./node_modules/react/index.js"),lib=__webpack_require__("./node_modules/@contentmunch/muncher-ui/lib/index.js");const defaultSublet={id:"",assetKey:"",email:"",firstName:"",lastName:"",bedroom:"1",availableBedrooms:"1",availableFrom:"",availableTo:"",rent:"",petsAllowed:!1,utilitiesIncluded:!0,address:"",zipcode:"",subletFolderId:"",photosFolderId:"",coverImage:"",title:"",description:"",createdDate:"",active:!0,approved:!1};var SubletService=__webpack_require__("./src/sublet/services/SubletService.ts"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const SubletNotFound_SubletNotFound=()=>(0,jsx_runtime.jsx)("section",{className:"sublet-full--center",children:(0,jsx_runtime.jsx)("h2",{children:"Uh-oh, this is a 404"})});try{SubletNotFound_SubletNotFound.displayName="SubletNotFound",SubletNotFound_SubletNotFound.__docgenInfo={description:"",displayName:"SubletNotFound",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/sublet/SubletNotFound.tsx#SubletNotFound"]={docgenInfo:SubletNotFound_SubletNotFound.__docgenInfo,name:"SubletNotFound",path:"src/sublet/SubletNotFound.tsx#SubletNotFound"})}catch(__react_docgen_typescript_loader_error){}var Utils=__webpack_require__("./src/utils/Utils.ts"),Captcha=__webpack_require__("./src/input/Captcha.tsx");const SubletSection_SubletSection=_ref=>{let{uniqueId}=_ref;const[sublet,setSublet]=(0,react.useState)(defaultSublet),[isFound,setIsFound]=(0,react.useState)(!0),[captchaResponse,setCaptchaResponse]=(0,react.useState)(""),[isSubmitting,setIsSubmitting]=(0,react.useState)(!1),[submissionErrorMessage,setSubmissionErrorMessage]=(0,react.useState)(""),[submissionMessage,setSubmissionMessage]=(0,react.useState)(""),[submitted,setSubmitted]=(0,react.useState)(!1),[files,setFiles]=(0,react.useState)([]),[filesError,setFilesError]=(0,react.useState)(""),[zipcodeError,setZipcodeError]=(0,react.useState)(""),[availableToError,setAvailableToError]=(0,react.useState)(""),[captchaError,setCaptchaError]=(0,react.useState)(""),[showDeactivationModal,setShowDeactivationModal]=(0,react.useState)(!1),bedroomOptions=["0","1","2","3","4"],isNewSublet=(0,react.useCallback)((()=>uniqueId===NEW_SUBLET),[uniqueId]);(0,react.useEffect)((()=>{isNewSublet()||(0,SubletService.Si)(uniqueId).then((data=>{setSublet(data)})).catch((()=>{setIsFound(!1)}))}),[uniqueId,isNewSublet]);const resetMessages=()=>{setAvailableToError(""),setZipcodeError(""),setCaptchaError(""),setFilesError(""),setSubmissionErrorMessage("")},cleanAddress=address=>address.replace(", Bloomington IN","");return(0,jsx_runtime.jsx)("section",{className:"section-sublet",children:isFound?(0,jsx_runtime.jsxs)("section",{className:"section-contact",children:[(0,jsx_runtime.jsx)("div",{className:"div-confirmation-modal",children:(0,jsx_runtime.jsxs)(lib.Modal,{show:showDeactivationModal,setShow:setShowDeactivationModal,children:[(0,jsx_runtime.jsx)("div",{className:"div-alert",children:(0,jsx_runtime.jsx)(lib.Icon,{name:"alert",size:"medium",children:"Delete Sublet?"})}),(0,jsx_runtime.jsxs)("div",{className:"buttons",children:[(0,jsx_runtime.jsx)(lib.Button,{variant:"danger",size:"small",onClick:()=>{(0,SubletService.Fz)(uniqueId).then((()=>{setSubmissionMessage("Sublet Deleted!"),setSubmitted(!0)})).catch((e=>{setSubmissionErrorMessage("Error deleting sublet!"),console.log(e)})).finally((()=>{setIsSubmitting(!1)})),setShowDeactivationModal(!1)},children:(0,jsx_runtime.jsx)(lib.Icon,{name:"trash",children:"Delete"})}),(0,jsx_runtime.jsx)(lib.Button,{variant:"secondary",size:"small",onClick:()=>setShowDeactivationModal(!1),children:(0,jsx_runtime.jsx)(lib.Icon,{name:"close",children:"Cancel"})})]})]})}),(0,jsx_runtime.jsxs)("div",{className:"container",children:[(0,jsx_runtime.jsx)("h2",{className:"heading",children:isNewSublet()?(0,jsx_runtime.jsx)("span",{className:"emphasized",children:"Post your sublet for free. Listing remains active for 30 days"}):(0,jsx_runtime.jsx)("span",{className:"emphasized",children:"Your Listing"})}),(0,jsx_runtime.jsxs)("form",{onSubmit:event=>{const form=event.currentTarget;if(event.preventDefault(),event.stopPropagation(),resetMessages(),0===files.length)return setFilesError("Provide at least an image!"),void setSubmissionErrorMessage("Fix field error(s)");if(form.checkValidity()){if(!(0,Utils.tS)(sublet.zipcode))return setZipcodeError("Provide valid zip code (ex: 47401)"),void setSubmissionErrorMessage("Fix field error(s)");if((0,Utils.iA)(sublet.availableFrom).isAfter((0,Utils.iA)(sublet.availableTo)))return setAvailableToError("Should be later than Available From date"),void setSubmissionErrorMessage("Fix field error(s)");if(""===captchaResponse)return setCaptchaError("Provide captcha"),void setSubmissionErrorMessage("Fix field error(s)");if((()=>{let fileInvalid=!1;return files.forEach(((file,index)=>{if((file=>file.size>4999999)(file))return setFilesError(file.name+" is too big, provide a file smaller than 5mb!"),setSubmissionErrorMessage("Fix field error(s)"),void(fileInvalid=!0)})),fileInvalid})())return;setIsSubmitting(!0),(0,SubletService.At)({...sublet,address:sublet.address+", Bloomington IN"},captchaResponse).then((value=>{setSublet(value),files.length>1&&files.push(files[0]),files.forEach(((file,index)=>{setIsSubmitting(!0),(0,SubletService.oL)(value.assetKey,file,index+"",0===index).finally((()=>{setIsSubmitting(!1)}))})),setSubmissionMessage("Sublet Created, It will be posted when approved!"),setSubmitted(!0)})).catch((e=>{setSubmissionErrorMessage("Error posting sublet!"),console.log(e)})).finally((()=>{setIsSubmitting(!1)}))}},children:[(0,jsx_runtime.jsx)("div",{className:"form-element",children:(0,jsx_runtime.jsx)(lib.Input,{label:"First Name",name:"firstName",icon:"user",type:"text",placeholder:"Type your first name",readOnly:!isNewSublet(),value:sublet.firstName,onChange:e=>{setSublet({...sublet,firstName:e.currentTarget.value})},required:!0})}),(0,jsx_runtime.jsx)("div",{className:"form-element",children:(0,jsx_runtime.jsx)(lib.Input,{label:"Last Name",name:"lastName",icon:"user",type:"text",placeholder:"Type your last name",value:sublet.lastName,readOnly:!isNewSublet(),onChange:e=>{setSublet({...sublet,lastName:e.currentTarget.value})},required:!0})}),(0,jsx_runtime.jsx)("div",{className:"form-element",children:(0,jsx_runtime.jsx)(lib.Input,{label:"Email",name:"email",icon:"mail",type:"email",placeholder:"Type your email",value:sublet.email,readOnly:!isNewSublet(),onChange:e=>{setSublet({...sublet,email:e.currentTarget.value})},required:!0})}),(0,jsx_runtime.jsx)("div",{className:"form-element",children:(0,jsx_runtime.jsx)("p",{children:"Your personal information is for verification purposes only and will not be displayed."})}),(0,jsx_runtime.jsxs)("div",{className:"form-element one-line",children:[(0,jsx_runtime.jsx)("select",{name:"availableBedrooms",value:sublet.availableBedrooms,onChange:e=>{setSublet({...sublet,availableBedrooms:e.currentTarget.value})},required:!0,disabled:!isNewSublet(),children:bedroomOptions.map(((option,i)=>(0,jsx_runtime.jsx)("option",{value:option,children:option},"select-option-"+i)))}),"  bedroom(s) available out of ",(0,jsx_runtime.jsx)("select",{name:"bedroom",required:!0,value:sublet.bedroom,onChange:e=>{setSublet({...sublet,bedroom:e.currentTarget.value})},disabled:!isNewSublet(),children:bedroomOptions.map(((option,i)=>(0,jsx_runtime.jsx)("option",{value:option,children:option},"select-option-"+i)))})," bedrooms."]}),(0,jsx_runtime.jsx)("div",{className:"form-element",children:(0,jsx_runtime.jsx)(lib.Input,{label:"Address",name:"address",icon:"map",type:"text",value:cleanAddress(sublet.address),onChange:e=>{setSublet({...sublet,address:cleanAddress(e.currentTarget.value)})},readOnly:!isNewSublet(),required:!0})}),(0,jsx_runtime.jsx)("div",{className:"form-element",children:(0,jsx_runtime.jsx)(lib.Input,{name:"address",icon:"map",type:"text",readOnly:!0,value:"Bloomington IN"})}),(0,jsx_runtime.jsx)("div",{className:"form-element",children:(0,jsx_runtime.jsx)(lib.Input,{label:"Zip Code",name:"zipcode",icon:"map",value:sublet.zipcode,onChange:e=>setSublet({...sublet,zipcode:e.currentTarget.value}),readOnly:!isNewSublet(),error:zipcodeError,placeholder:"Provide Zip Code (ex: 47404)",required:!0})}),(0,jsx_runtime.jsx)("div",{className:"form-element",children:(0,jsx_runtime.jsx)(lib.Input,{label:"Available From",name:"availableFrom",type:"date",icon:"calendar",value:sublet.availableFrom,onChange:e=>{setSublet({...sublet,availableFrom:e.currentTarget.value})},readOnly:!isNewSublet(),required:!0})}),(0,jsx_runtime.jsx)("div",{className:"form-element",children:(0,jsx_runtime.jsx)(lib.Input,{label:"Available To",name:"availableTo",type:"date",icon:"calendar",value:sublet.availableTo,onChange:e=>{setSublet({...sublet,availableTo:e.currentTarget.value})},readOnly:!isNewSublet(),required:!0,error:availableToError})}),(0,jsx_runtime.jsx)("div",{className:"form-element",children:(0,jsx_runtime.jsx)(lib.Input,{label:"Rent",name:"rent",type:"number",value:sublet.rent,onChange:e=>{setSublet({...sublet,rent:e.currentTarget.value})},readOnly:!isNewSublet(),required:!0})}),(0,jsx_runtime.jsxs)("div",{className:"checkboxes form-element",children:[(0,jsx_runtime.jsx)(lib.Checkbox,{label:"Including Utilities",name:"utilitiesIncluded",checked:sublet.utilitiesIncluded,onChange:()=>{setSublet({...sublet,utilitiesIncluded:!sublet.utilitiesIncluded})}}),(0,jsx_runtime.jsx)(lib.Checkbox,{label:"Pets OK",name:"petsAllowed",checked:sublet.petsAllowed,onChange:()=>{setSublet({...sublet,petsAllowed:!sublet.petsAllowed})}})]}),(0,jsx_runtime.jsx)("div",{className:"form-element",children:(0,jsx_runtime.jsx)(lib.Input,{label:"Title",name:"title",type:"text",value:sublet.title,onChange:e=>{setSublet({...sublet,title:e.currentTarget.value})},maxLength:50,placeholder:"Listing title",readOnly:!isNewSublet(),required:!0})}),(0,jsx_runtime.jsx)("div",{className:"form-element",children:(0,jsx_runtime.jsx)(lib.Textarea,{name:"description",label:"Description",required:!0,onChange:e=>{setSublet({...sublet,description:e.currentTarget.value})},placeholder:"Enter a description of the rental you are subleasing",maxLength:500,value:sublet.description,readOnly:!isNewSublet()})}),(0,jsx_runtime.jsx)("br",{}),isNewSublet()?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("div",{className:"form-element",children:[(0,jsx_runtime.jsx)(lib.ImageInput,{label:"Upload Images",multiple:!0,name:"imageFiles",required:!0,maxFiles:5,setFiles:data=>{setFiles(data)},error:filesError}),(0,jsx_runtime.jsx)("div",{className:"info",children:(0,jsx_runtime.jsx)(lib.Icon,{name:"info",children:"Upto 5 images. First image will be cover image."})})]}),(0,jsx_runtime.jsx)(Captcha.U,{setCaptchaResponse,error:captchaError})]}):"",(0,jsx_runtime.jsxs)("div",{className:"form-element",children:[""!==submissionMessage?(0,jsx_runtime.jsx)("p",{className:"text-success message",children:submissionMessage}):"",""!==submissionErrorMessage?(0,jsx_runtime.jsx)("p",{className:"text-danger message",children:submissionErrorMessage}):""]}),(0,jsx_runtime.jsxs)("div",{className:"form-element form-submit",children:[isNewSublet()?(0,jsx_runtime.jsx)(lib.Button,{variant:"primary",size:"large",type:"submit",disabled:submitted,children:(0,jsx_runtime.jsx)(lib.Icon,{name:"send",orientation:"right",children:"Submit"})}):(0,jsx_runtime.jsx)(lib.Button,{variant:"danger",size:"large",type:"button",disabled:submitted,onClick:()=>{setShowDeactivationModal(!0)},children:(0,jsx_runtime.jsx)(lib.Icon,{name:"trash",orientation:"right",children:"Delete"})}),isSubmitting?(0,jsx_runtime.jsx)(lib.Spinner,{size:"small"}):""]})]})]})]}):(0,jsx_runtime.jsx)(SubletNotFound_SubletNotFound,{})})},NEW_SUBLET="new";try{SubletSection_SubletSection.displayName="SubletSection",SubletSection_SubletSection.__docgenInfo={description:"",displayName:"SubletSection",props:{uniqueId:{defaultValue:null,description:"",name:"uniqueId",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/sublet/SubletSection.tsx#SubletSection"]={docgenInfo:SubletSection_SubletSection.__docgenInfo,name:"SubletSection",path:"src/sublet/SubletSection.tsx#SubletSection"})}catch(__react_docgen_typescript_loader_error){}const SubletSection_stories={title:"Section/SubletSection",component:SubletSection_SubletSection},Default=(args=>(0,jsx_runtime.jsx)(SubletSection_SubletSection,{...args})).bind({});Default.args={uniqueId:NEW_SUBLET},Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"args => <SubletSection {...args} />",...Default.parameters?.docs?.source}}};const __namedExportsOrder=["Default"]},"./src/input/Captcha.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{U:()=>Captcha});var react=__webpack_require__("./node_modules/react/index.js"),esm=__webpack_require__("./node_modules/react-google-recaptcha/lib/esm/index.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const Captcha=_ref=>{let{setCaptchaResponse,error}=_ref;const[isCaptchaValid,setIsCaptchaValid]=(0,react.useState)(!0);return(0,jsx_runtime.jsxs)("div",{className:"captcha form-element",children:[(0,jsx_runtime.jsx)(esm.Z,{sitekey:"6LfibLwZAAAAALSCyZLLwPk-0hV5wmjCjE2F1MCZ",onChange:value=>{setIsCaptchaValid(!1),null!==value&&(setIsCaptchaValid(!0),setCaptchaResponse(value))}}),(0,jsx_runtime.jsx)("p",{className:"text-danger",hidden:isCaptchaValid,children:"Please check the captcha"}),error&&""!==error?(0,jsx_runtime.jsx)("p",{className:"text-danger",children:error}):""]})};try{Captcha.displayName="Captcha",Captcha.__docgenInfo={description:"",displayName:"Captcha",props:{setCaptchaResponse:{defaultValue:null,description:"method to set captcha response token to compare with server side integration\n@param token :  a valid captcha response token",name:"setCaptchaResponse",required:!0,type:{name:"(token: string) => void"}},error:{defaultValue:null,description:"",name:"error",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/input/Captcha.tsx#Captcha"]={docgenInfo:Captcha.__docgenInfo,name:"Captcha",path:"src/input/Captcha.tsx#Captcha"})}catch(__react_docgen_typescript_loader_error){}},"./src/service/AdminApi.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=__webpack_require__("./node_modules/axios/lib/axios.js").Z.create({baseURL:"https://admin.renaissancerentals.com/api/"})},"./src/sublet/services/SubletService.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{At:()=>postSublet,Fz:()=>deleteSublet,NF:()=>getSublets,Si:()=>getSublet,bG:()=>sendMessage,oL:()=>postAsset});var _service_AdminApi__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/service/AdminApi.ts");const getSublets=()=>_service_AdminApi__WEBPACK_IMPORTED_MODULE_0__.Z.get("sublets/search/findByActiveTrueAndApprovedTrue?projection=withId").then((response=>response.data._embedded.sublets)),getSublet=assetKey=>_service_AdminApi__WEBPACK_IMPORTED_MODULE_0__.Z.get("sublets/search/byAssetKey?projection=withId&assetKey="+assetKey).then((response=>response.data)),postSublet=(sublet,captchaResponse)=>_service_AdminApi__WEBPACK_IMPORTED_MODULE_0__.Z.post("admin/sublets?captchaResponse="+captchaResponse,{...sublet}).then((response=>response.data)),deleteSublet=assetKey=>_service_AdminApi__WEBPACK_IMPORTED_MODULE_0__.Z.delete("admin/sublets/"+assetKey),postAsset=(assetKey,file,name,isCoverImage,onUploadProgress)=>{let formData=new FormData;return formData.append("name",name),formData.append("file",file),formData.append("isCoverImage",isCoverImage+""),console.log("Uploading image: ",name," for asset: ",assetKey),_service_AdminApi__WEBPACK_IMPORTED_MODULE_0__.Z.post("admin/sublets/assets/"+assetKey,formData,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress}).then((response=>response.data))},sendMessage=(subletId,subletMessage,captchaResponse)=>(console.log("sending..."),_service_AdminApi__WEBPACK_IMPORTED_MODULE_0__.Z.post("admin/sublets/"+subletId+"/message?captchaResponse="+captchaResponse,{...subletMessage}))},"./src/utils/Utils.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{G_:()=>momentToDate,Jx:()=>decode,K3:()=>extractIdFrom,Nb:()=>addressToGoogleMapLink,Rt:()=>rangeFrom,ZG:()=>addressToGoogleMap,fH:()=>floorplanAddressToGoogleMap,fm:()=>capitalizeFirstLetter,gq:()=>enumToString,hm:()=>youtubeUrlToEmbedUrl,iA:()=>dateToMoment,mh:()=>minimumMaximum,p6:()=>formatDate,tF:()=>toUSD,tQ:()=>isGoogleDriveImage,tS:()=>isZipcodeValid,un:()=>formatPhoneNumber});var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/lodash/lodash.js"),lodash__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_0__),moment__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/moment/moment.js"),moment__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_1__),html_entities__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/html-entities/lib/index.js");const formatPhoneNumber=phone=>{if(!phone)return"";const match=phone.toString().match(/^(\d{3})(\d{3})(\d{4})$/);return match?"("+match[1]+")-"+match[2]+"-"+match[3]:phone},cleanAddressForGoogle=address=>address?address.replace(/apt. /gi,""):"",addressToGoogleMapLink=(address,zipcode)=>"https://maps.google.com/?q="+cleanAddressForGoogle(address)+","+zipcode,addressToGoogleMap=(address,zipcode)=>"https://www.google.com/maps?output=embed&q="+cleanAddressForGoogle(address)+","+zipcode,floorplanAddressToGoogleMap=floorplanAddress=>"https://www.google.com/maps?output=embed&q="+cleanAddressForGoogle(floorplanAddress.address)+", "+floorplanAddress.city+", "+floorplanAddress.state+" "+floorplanAddress.zipcode,enumToString=value=>{return value&&((object=value)&&!lodash__WEBPACK_IMPORTED_MODULE_0___default().isEmpty(object))?value.replaceAll("_"," ").toLowerCase():"";var object},capitalizeFirstLetter=value=>{if(value){let lowerCased=value.toLowerCase();return lowerCased.charAt(0).toUpperCase()+lowerCased.slice(1)}return value},toUSD=num=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0}).format(num),youtubeUrlToEmbedUrl=youtubeUrl=>"https://www.youtube.com/embed/"+youtubeUrl.split("/").pop()+"?rel=0",isGoogleDriveImage=imageUrl=>imageUrl&&imageUrl.includes("drive.google.com"),extractIdFrom=imageUrl=>{if(imageUrl){const paramString=imageUrl.split("?")[1],id=new URLSearchParams(paramString).get("id");return null===id?"":id}return""},minimumMaximum=(arr,field)=>{try{const sorted=arr.filter((value=>!value.active||value.active)).sort(((a,b)=>a[field]&&b[field]?a[field]-b[field]:0));return{min:sorted[0][field],max:sorted[sorted.length-1][field]}}catch(e){return{min:0,max:0}}},rangeFrom=(arr,field)=>{if(arr&&arr.length>0){const minMax=minimumMaximum(arr,field);return minMax.min===minMax.max?minMax.min.toString():minMax.min+" - "+minMax.max}return"-"},dateToMoment=date=>moment__WEBPACK_IMPORTED_MODULE_1___default()(date,"YYYY-MM-DD"),momentToDate=date=>date.format("YYYY-MM-DD"),decode=content=>(0,html_entities__WEBPACK_IMPORTED_MODULE_2__.decodeEntity)(content),formatDate=date=>moment__WEBPACK_IMPORTED_MODULE_1___default()(date,"YYYY-MM-DD").format("MMM DD, YYYY"),isZipcodeValid=zipcode=>{if(!zipcode)return!0;return/^\d{5}$/.test(zipcode)}}}]);